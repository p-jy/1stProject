<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="db.dao.BookMapper">

    <resultMap type="db.model.vo.BookVO" id="BookMap">
        <!-- property : BookVO의 필드명, column : book 테이블의 속성명 -->
        <id property="bo_code" column="bo_code"/>
        <result property="bo_title" column="bo_title"/>
        <result property="bo_author" column="bo_author"/>
        <result property="bo_publisher" column="bo_publisher"/>
        <result property="bo_del" column="bo_del"/>
        <result property="bo_rent" column="bo_rent"/>
        <result property="bo_ca_num" column="bo_ca_num"/>
    </resultMap>

    <!-- 도서 등록 -->
    <insert id="registBook" parameterType="db.model.vo.BookVO">
        INSERT INTO book (bo_code, bo_title, bo_author, bo_publisher, bo_rent, bo_del, bo_ca_num)
        VALUES (#{bo_code}, #{bo_title}, #{bo_author}, #{bo_publisher}, #{bo_rent}, #{bo_del}, #{bo_ca_num})
    </insert>

    <!-- 도서 수정 -->
    <update id="updateBook" parameterType="db.model.vo.BookVO">
        UPDATE book
        SET bo_title = #{bo_title}, bo_author = #{bo_author}, bo_publisher = #{bo_publisher},
            bo_rent = #{bo_rent}, bo_del = #{bo_del}, bo_ca_num = #{bo_ca_num}
        WHERE bo_code = #{bo_code}
    </update>

    <!-- 도서 삭제 -->
    <delete id="deleteBook" parameterType="String">
        DELETE FROM book WHERE bo_code = #{bo_code}
    </delete>

    <!-- 도서 조회 (도서 코드로) -->
    <select id="selectBookByCode" resultMap="BookMap" parameterType="String">
        SELECT * FROM book WHERE bo_code = #{bo_code}
    </select>

    <!-- 전체 도서 목록 조회 -->
    <select id="selectAllBooks" resultMap="BookMap">
        SELECT * FROM book
    </select>

    <!-- 도서 제목으로 검색 -->
    <select id="searchBooksByTitle" resultMap="BookMap" parameterType="String">
        SELECT * FROM book WHERE bo_title LIKE CONCAT('%', #{bo_title}, '%')
    </select>

    <!-- 작가명으로 도서 검색 -->
    <select id="searchBooksByAuthor" resultMap="BookMap" parameterType="String">
        SELECT * FROM book WHERE bo_author LIKE CONCAT('%', #{bo_author}, '%')
    </select>

    <!-- 출판사로 도서 검색 -->
    <select id="searchBooksByPublisher" resultMap="BookMap" parameterType="String">
        SELECT * FROM book WHERE bo_publisher LIKE CONCAT('%', #{bo_publisher}, '%')
    </select>

    <!-- 도서 코드로 도서 검색 -->
    <select id="searchBooksByCode" resultMap="BookMap" parameterType="String">
        SELECT * FROM book WHERE bo_code = #{bo_code}
    </select>
</mapper>